# IDatabaseApi.ExecuteDataset method (1 of 6)

使用所提供的参数对连接字符串中指定的数据库执行命令并返回DataSet。

```csharp
public DataSet ExecuteDataset(IDbConnection connection, string sqlString)
```

| parameter | description |
| --- | --- |
| connection | 有效的IDbConnection。 |
| sqlString | SELECT SQL 语句。 |

## Return Value

命令执行后获取的DataSet。

## Exceptions

| exception | condition |
| --- | --- |
| ArgumentNullException | 如果connection为空，则抛出。 |
| ArgumentNullException | 如果sqlString为空，则抛出。 |

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

---

# IDatabaseApi.ExecuteDataset method (2 of 6)

使用所提供的参数对连接字符串中指定的数据库执行命令并返回DataSet。

```csharp
public DataSet ExecuteDataset(IDbTransaction transaction, string sqlString)
```

| parameter | description |
| --- | --- |
| transaction | 有效的IDbTransaction。 |
| sqlString | SELECT SQL 语句。 |

## Return Value

命令执行后获取的DataSet。

## Exceptions

| exception | condition |
| --- | --- |
| ArgumentNullException | 如果sqlString为空，则抛出。 |
| ArgumentNullException | 如果transaction为空，则抛出。 |
| ArgumentNullException | 如果transaction.Connection为空，则抛出。 |

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

---

# IDatabaseApi.ExecuteDataset method (3 of 6)

对连接字符串中指定的数据库执行命令并返回DataSet。

```csharp
public DataSet ExecuteDataset(string connectionString, string sqlString)
```

| parameter | description |
| --- | --- |
| connectionString | 数据库连接字符串。 |
| sqlString | SELECT SQL 语句。 |

## Return Value

命令执行后获取的DataSet。

## Exceptions

| exception | condition |
| --- | --- |
| ArgumentNullException | 如果connectionString为空，则抛出。 |
| ArgumentNullException | 如果sqlString为空，则抛出。 |

## Examples

```csharp
DataSet ds = databaseApi.ExecuteDataset(connString, "SELECT * FROM table");
```

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

---

# IDatabaseApi.ExecuteDataset method (4 of 6)

使用所提供的参数对连接字符串中指定的数据库执行命令并返回DataSet。

```csharp
public DataSet ExecuteDataset(IDbConnection connection, string sqlString, 
    IDataParameter[] commandParameters)
```

| parameter | description |
| --- | --- |
| connection | 有效的IDbConnection。 |
| sqlString | SELECT SQL 语句。 |
| commandParameters | 用于执行命令的IDataParameter数组。 |

## Return Value

命令执行后获取的DataSet。

## Exceptions

| exception | condition |
| --- | --- |
| InvalidOperationException | 如果有任何IDataParameters参数名为空，或者如果参数计数不匹配所提供的值的数量，则抛出。 |
| ArgumentNullException | 如果sqlString为空，则抛出。 |
| ArgumentException | 如果参数计数与提供的值数量不匹配，则抛出。 |
| ArgumentNullException | 如果connection为空，则抛出。 |

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

---

# IDatabaseApi.ExecuteDataset method (5 of 6)

使用所提供的参数对连接字符串中指定的数据库执行命令并返回DataSet。

```csharp
public DataSet ExecuteDataset(IDbTransaction transaction, string sqlString, 
    IDataParameter[] commandParameters)
```

| parameter | description |
| --- | --- |
| transaction | 有效的IDbTransaction。 |
| sqlString | SELECT SQL 语句。 |
| commandParameters | 用于执行命令的IDataParameter数组。 |

## Return Value

命令执行后获取的DataSet。

## Exceptions

| exception | condition |
| --- | --- |
| InvalidOperationException | 如果有任何IDataParameters参数名为空，或者如果参数计数不匹配所提供的值的数量，则抛出。 |
| ArgumentNullException | 如果sqlString为空，则抛出。 |
| ArgumentException | 如果参数计数与提供的值数量不匹配，则抛出。 |
| ArgumentNullException | 如果transaction为空，则抛出。 |
| ArgumentNullException | 如果transaction.Connection为空，则抛出。 |

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

---

# IDatabaseApi.ExecuteDataset method (6 of 6)

使用所提供的参数对连接字符串中指定的数据库执行命令并返回DataSet。

```csharp
public DataSet ExecuteDataset(string connectionString, string sqlString, 
    IDataParameter[] commandParameters)
```

| parameter | description |
| --- | --- |
| connectionString | 数据库连接字符串。 |
| sqlString | SELECT SQL 语句。 |
| commandParameters | 用于执行命令的IDbParamters的数组。 |

## Return Value

命令执行后获取的DataSet。

## Exceptions

| exception | condition |
| --- | --- |
| ArgumentNullException | 如果connectionString为空，则抛出。 |
| InvalidOperationException | 如果有任何IDataParameters参数名为空，或者如果参数计数不匹配所提供的值的数量，则抛出。 |
| ArgumentNullException | 如果sqlString为空，则抛出。 |
| ArgumentException | 如果参数计数与提供的值数量不匹配，则抛出。 |

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

<!-- DO NOT EDIT: generated by xmldocmd for SiteServer.Plugin.dll -->
