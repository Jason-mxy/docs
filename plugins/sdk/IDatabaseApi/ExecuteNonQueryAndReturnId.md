# IDatabaseApi.ExecuteNonQueryAndReturnId method (1 of 2)

执行INSERT SQL命令并返回自增长Id的值。

```csharp
public int ExecuteNonQueryAndReturnId(string tableName, string idColumnName, 
    IDbTransaction transaction, string sqlString, IDataParameter[] commandParameters)
```

| parameter | description |
| --- | --- |
| tableName | 表名称。 |
| idColumnName | 自增长字段名称。 |
| transaction | 有效的IDbTransaction。 |
| sqlString | INSERT SQL语句。 |
| commandParameters | 用于执行命令的IDataParameter数组。 |

## Return Value

INSERT SQL语句执行后表生成的自增长Id。

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

---

# IDatabaseApi.ExecuteNonQueryAndReturnId method (2 of 2)

执行INSERT SQL命令并返回自增长Id的值。

```csharp
public int ExecuteNonQueryAndReturnId(string tableName, string idColumnName, 
    string connectionString, string sqlString, IDataParameter[] commandParameters)
```

| parameter | description |
| --- | --- |
| tableName | 表名称。 |
| idColumnName | 自增长字段名称。 |
| connectionString | 数据库连接字符串。 |
| sqlString | INSERT SQL语句。 |
| commandParameters | 用于执行命令的IDataParameter数组。 |

## Return Value

INSERT SQL语句执行后表生成的自增长Id。

## See Also

* interface [IDatabaseApi](../IDatabaseApi.md)
* namespace [SiteServer.Plugin](../../SiteServer.Plugin.md)

<!-- DO NOT EDIT: generated by xmldocmd for SiteServer.Plugin.dll -->
